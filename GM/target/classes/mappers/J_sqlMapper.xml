<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.spring.gm.persistence.J_DAO" >
	
	<select id="selectCnt" parameterType="java.util.Map" resultType="int">
		SELECT COUNT(*) as cnt FROM member where company = #{company}
	</select>
	<!-- 급여 회원정보 가져오기(부서번호가 회사명) -->
	<select id="selectList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank order by m.depart ,r.r_name)
        WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart = #{company}
	]]>
	</select>
	<!-- 급여 회원정보 가져오기(부서번호가 부서명) -->
	<select id="selectList3" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g , grade r
              WHERE m.depart = g.groupid and m.rank = r.rank order by m.depart ,r.r_name)
        WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart != #{company}
	]]>
	</select>
	<!--  -->
	<select id="infoList" parameterType="String" resultType="com.spring.gm.vo.MemberVO">
		SELECT * FROM member WHERE id=#{id}
	</select>
	<!--개인 회원 급여 수정하기  -->
	<update id="infoUpdate" parameterType="java.util.Map">
		UPDATE member SET salary=#{salary}, account_number=#{account_number} WHERE id=#{id}
	</update>
	
	<!-- 검색 급여 회원정보 가져오기(성명) -->
	<select id="search_salaryCnt" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt FROM member WHERE name like '%'||#{search_content}||'%' and company = #{company}
	</select>
	<!-- 검색 급여 회원정보 가져오기(성명 - 그룹테이블과 조인) -->
	<select id="searchinfoList" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		select * from(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank)
     where  depart != #{company} and name like '%'||#{search_content}||'%'
	</select>
	<!-- 검색 급여 회원정보 가져오기(성명 - 사업장테이블과 조인) -->
	<select id="searchinfoList3" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank)
     where  depart = #{company} and name like '%'||#{search_content}||'%'
	</select>
	
	
	<!-- 검색 급여 회원정보 가져오기(부서) -->
	<select id="search_salaryCnt2" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt FROM groups WHERE g_name like '%'||#{search_content}||'%' and company = #{company}
	</select>
	<select id="searchinfoList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r
              WHERE m.depart = g.groupid and m.rank = r.rank
              and g.g_name like '%'||#{search_content}||'%' and g.company = #{company})
	</select>
	
	
	<!-- 검색 급여 회원정보 가져오기(사원 아이디) -->
	<select id="search_salaryCnt3" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt FROM member WHERE id = #{search_content} and company = #{company}
	</select>
	<!-- 검색 급여 회원정보 가져오기(사원 아이디 - 그룹테이블과 조인) -->
	<select id="searchinfoList4" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		select * from(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank)
     where  depart != #{company} and id like '%'||#{search_content}||'%'
	</select>
	<!-- 검색 급여 회원정보 가져오기(성명 - 사업장테이블과 조인) -->
	<select id="searchinfoList5" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank)
     where  depart = #{company} and id like '%'||#{search_content}||'%'
	</select>
	
	
	<!--개인 급여등록(이번달 목록 가져오기) -->
	<select id="J_PayrollRegistrationCnt" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt 
		FROM salary s, member m
		where s.id = m.id
		and to_char(s.day,'yyyymm')=to_char(sysdate,'yyyymm') and m.id = #{id} and company = #{company}
	</select>
	<select id="J_PayrollRegistrationList" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_msVO">
		SELECT s.sal_num, s.id, m.name, m.tel,r.r_name, s.day, s.state, m.email_in, s.salary, m.account_number
		from member m, salary s, grade r
		where m.id = s.id and m.rank = r.rank
		and s.id = #{id} and m.company = #{company} and to_char(s.day,'yyyymm')=to_char(sysdate,'yyyymm')
	</select>
	<!--개인 급여등록(이번달 목록 가져오기) 없으면 인설트할 목록 가져오기 -->
	<select id="J_PayrollRegistrationInsertList" parameterType="java.util.Map" resultType="com.spring.gm.vo.MemberVO">
		SELECT id,name,tel,email_in,round(salary/12, -2) as salary,account_number FROM member where  id = #{id} and company = #{company}
	</select>
	
	<!--  개인 급여등록 -->
	<insert id="J_PayrollRegistrationInsert" parameterType="java.util.Map">
		INSERT INTO salary(sal_num, id, day, state, salary, del)
		VALUES (seq_salary.nextval,#{id}, to_date(#{month},'yyyy/mm'), #{state}, #{salary}, 0)
	</insert>
	<!-- 미지급 지급으로 처리 -->
	<update id="J_PayrollRegistrationchange" parameterType="java.util.Map">
		update salary set state = #{state} where id=#{id} and to_char(day,'yyyymm')=to_char(sysdate,'yyyymm')
	</update>
	<!--정보 삭제 -->
	<delete id="J_PayrollRegistrationListDelete" parameterType="java.util.Map">
		delete salary where sal_num = #{sal_num} and id= #{id}
	</delete>
	
	
	<!-- ========================기본수당 외 수당관리=============================-->
	<!-- 회사명 가져오기 -->
	<select id="companyName" parameterType="int" resultType="com.spring.gm.vo.CompaniesVO">
		SELECT C_NAME FROM COMPANIES WHERE COMPANY = #{company}
	</select>
	
	
	<!--수당  검색 회원목록  가져오기(id검색)  -->
	<!--입사일 년,도로 기준  -->
	<select id="salaryIdSearchList1_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
	SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
               and to_char(m.enterday,'yyyy') <= #{content})
        WHERE  depart = #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<select id="salaryIdSearchList1_2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyy')<= #{content})
         WHERE  depart != #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<select id="salaryIdSearchList2_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and to_char(m.enterday,'yyyymm') <= #{content})
        WHERE  depart = #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<select id="salaryIdSearchList2_2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymm')<= #{content})
         WHERE  depart != #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<select id="salaryIdSearchList3_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and to_char(m.enterday,'yyyymmdd') <= #{content})
        WHERE  depart = #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<select id="salaryIdSearchList3_2" parameterType="java.util.Map"  resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, m.rank, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymmdd')<= #{content})
         WHERE  depart != #{company} and id like '%'||#{content2}||'%'
	]]>
	</select>
	<!--수당  검색 회원목록  가져오기(depart검색)  -->
	<!--입사일 년,도로 기준  -->
	<select id="salaryDepartSearchList1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
	SELECT * FROM(SELECT m.id, m.name, m.rank, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyy') <= #{content} and g_name like '%'||#{content2}||'%' and  m.company = #{company})
	]]>
	</select>
	<select id="salaryDepartSearchList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, m.rank, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymm') <= #{content} and g_name like '%'||#{content2}||'%' and  m.company = #{company})
	]]>
	</select>
	<select id="salaryDepartSearchList3" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymmdd') <= #{content} and g_name like '%'||#{content2}||'%' and  m.company = #{company})
	]]>
	</select>
	
	<!-- 수당 검색 회원목록 갯수 가져오기(부서 날짜검색 안했을시) -->
	<select id="selectNoneDepartCnt" parameterType="java.util.Map" resultType="int">
		SELECT COUNT(*) as cnt FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and g.g_name like '%'||#{content2}||'%' and m.company = #{company})
	</select>
	<select id="selectNoneDepartList" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and g.g_name like '%'||#{content2}||'%' and m.company = #{company})
        WHERE (rNum >=  #{start} AND rNum <= #{end})
     ]]>
	</select>
	
	<!-- 수당 검색 회원목록 갯수 가져오기(아이디 날짜검색 안했을시) -->
	<select id="selectNoneIdCnt" parameterType="java.util.Map" resultType="int">
		SELECT COUNT(*) as cnt FROM member where company = #{company} and id like '%'||#{content2}||'%'
	</select>
	<select id ="selectNoneIdList" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and id like '%'||#{content2}||'%' and m.company = #{company})
        WHERE (rNum >=  #{start} AND rNum <= #{end})
	]]>	
	</select>
	<select id ="selectNoneIdList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and id like '%'||#{content2}||'%' and m.company = #{company})
       WHERE (rNum >=  #{start} AND rNum <= #{end})
	]]>	
	</select>
	
	
	
	<!-- 급여 개인회원수당 정보 있는지확인 -->
	<select id="J_extrapayinfoCnt" parameterType="String" resultType="int">
		SELECT count(*) as cnt FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymm')=to_char(sysdate,'yyyymm')
	</select>
	<!-- 급여 개인회원수당 정보 가져오기 -->
	<select id="J_extrapayinfo" parameterType="String" resultType="com.spring.gm.vo.BonusCutVO">
		SELECT * FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymm')=to_char(sysdate,'yyyymm')
	</select>
	
	<!-- 급여 개인회원수당 정보 있는지확인(날짜검색) -->
	<select id="J_extrapayinfoCnt2_1" parameterType="java.util.Map" resultType="int">
		SELECT count(*) as cnt FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyy') = #{content}
	</select>
	<select id="J_extrapayinfoCnt2_2" parameterType="java.util.Map" resultType="int">
		SELECT count(*) as cnt FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymm') = #{content}
	</select>
	<select id="J_extrapayinfoCnt2_3" parameterType="java.util.Map" resultType="int">
		SELECT count(*) as cnt FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymmdd') = #{content}
	</select>
	<!-- 급여 개인회원수당 정보 가져오기(날짜검색)-->
	<select id="J_extrapayinfo2_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.BonusCutVO">
		SELECT * FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyy') = #{content}
	</select>
	<select id="J_extrapayinfo2_2" parameterType="java.util.Map" resultType="com.spring.gm.vo.BonusCutVO">
		SELECT * FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymm') = #{content}
	</select>
	<select id="J_extrapayinfo2_3" parameterType="java.util.Map" resultType="com.spring.gm.vo.BonusCutVO">
		SELECT * FROM bonus_cut WHERE id = #{id} and to_char(day,'yyyymmdd') = #{content}
	</select>
	
	
	<!-- 개인 급여수당정보 업데이트 -->
	<update id="J_extrapayinfoUpdate" parameterType="java.util.Map">
		INSERT INTO bonus_cut (num, id, type, day, cost, content, state,  del)
		VALUES (seq_bonus_cut.nextval,#{id}, #{type}, sysdate, #{cost}, #{content}, #{state}, 0)
	</update>
	<!-- 개인 급여수당정보 삭제하기 -->
	<delete id="deleteInfo" parameterType="int">
		delete bonus_cut where num=#{num}
	</delete>
	<!-- 개인 num에대한 id 값 가져오기 -->
	<select id = "numId" parameterType="int" resultType="com.spring.gm.vo.BonusCutVO">
		select id from bonus_cut where num = #{num}
	</select>
	
	<!-- 날짜만 입력하여 검색시 -->
	<select id="salarySearchList1_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
	SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and to_char(m.enterday,'yyyy') <= #{content})
       WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart = #{company}
	]]>
	</select>
	<select id="salarySearchList1_2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyy')<= #{content})
         WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart != #{company}
	]]>
	</select>
	<select id="salarySearchList2_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and to_char(m.enterday,'yyyymm') <= #{content})
        WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart = #{company}
	]]>
	</select>
	<select id="salarySearchList2_2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g , grade r
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymm')<= #{content})
         WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart != #{company}
	]]>
	</select>
	<select id="salarySearchList3_1" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank
              and to_char(m.enterday,'yyyymmdd') <= #{content})
        WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart = #{company}
	]]>
	</select>
	<select id="salarySearchList3_2" parameterType="java.util.Map"  resultType="com.spring.gm.vo.join_mgcVO2">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name, rownum rNum
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank
              and to_char(m.enterday,'yyyymmdd')<= #{content})
         WHERE (rNum >=  #{start} AND rNum <= #{end}) and depart != #{company}
	]]>
	</select>
	<!-- 수정할 목록 불러오기 -->
	<select id ="J_ExtrapayInfoModified" parameterType="int" resultType="com.spring.gm.vo.BonusCutVO">
		select *  from bonus_cut where num = #{num}
	</select>
	<!-- 수정 업데이트 -->
	<update id ="J_ExtrapayInfoModifiedComplete" parameterType="java.util.Map">
		UPDATE bonus_cut SET type=#{type}, cost=#{cost}, content=#{content},state=#{state} where num = #{num}
	</update>
	
	
	<!--==================================상여급여 조회====================================-->
	<!-- 상여 조회(아이디 검색 정보 가져오기) -->
	<select id="searchIdCnt" parameterType="java.util.Map" resultType="int">
		SELECT COUNT(*) as cnt FROM member where company = #{company} and id like '%'||#{id}||'%'
	</select>
	<select id="searchIdList" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
		select * from(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, g.g_name as j_name
              FROM member m ,groups g, grade r 
              WHERE m.depart = g.groupid and m.rank = r.rank)
     	where  depart != #{company} and id like '%'||#{id}||'%'
	</select>
     <select id="searchIdList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO2">
	 	SELECT * FROM(SELECT m.id, m.name, r.r_name, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name
              FROM member m ,companies c, grade r
              WHERE m.depart = c.company and m.rank = r.rank)
    	 where  depart = #{company} and id like '%'||#{id}||'%'
	</select>
     
     <!--==================================급여 조회====================================-->
     <!-- 급여 조회&수당(cnt) -->
     <select id="mgstblCnt" parameterType="java.util.Map" resultType="int">
     	SELECT count(*) as cnt
              FROM member m , salary s
              WHERE  m.id = s.id 
              and to_char(s.day,'yyyymm') = #{months} and  m.id = #{id} and  m.company = #{company} and state = '지급'
     </select>
     <select id="mgstblCnt2" parameterType="java.util.Map" resultType="int">
		select count(*) as cnt from bonus_cut where id= #{id} and to_char(day,'yyyymm') = #{months} and state = '지급'
     </select>
     <!-- 급여 조회&수당(List) -->
     <!-- 급여 부서명 가져오는  셀리리조인 -->
     <select id="mgstbl" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
        select s.day, m.id, m.name, g.g_name as j_name, s.salary as salary
		from member m, groups g, salary s
		where m.depart = g.groupid and m.id = s.id
		and m.id = #{id} and m.depart != #{company} and m.company = #{company} and to_char(s.day,'yyyymm')= #{months} and state = '지급'
     </select>
	<!-- 급여 회사명 가져오는  셀리리조인 -->
	<select id="mgstbl2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
		select s.day as day, m.id, m.name, c.c_name as j_name, s.salary as salary
		from member m, companies c, salary s
		where m.company = c.company and m.id = s.id
		and m.id = #{id} and m.depart = #{company} and m.company =  #{company} and to_char(s.day,'yyyymm')= #{months} and state = '지급'
     </select>
     <!-- Bonus_cut 정보 가져오기 -->
     <select id="bonustbl" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
     	select sum(b.cost) as bonussalary 
		from member m,bonus_cut b
		where m.id = b.id
		and m.id= #{id} and to_char(day,'yyyymm') = #{months} and m.company = #{company} and state = '지급'
     </select>
      <select id="bonustbl2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
     	select * from bonus_cut b,member m  
		where m.id = b.id
		and m.id= #{id} and to_char(day,'yyyymm') = #{months} and m.company = #{company} and state = '지급'
     </select>
     
     
     
     <!--=====================급여 계산=============================-->
     <!-- 급여 계산 목록 가져오기 -->
     <select id = "J_SalaryCalculationSearchCnt"  parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
		     select count(*) as cnt
			from salary s,member m  
			where m.id = s.id
			and m.id= #{id} and to_char(day,'yyyy') = to_char(sysdate, 'yyyy') and m.company =  #{company}
     </select>
     <select id = "J_SalaryCalculationSearchList"  parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
     	select s.sal_num, s.id, s.day, s.salary, s.state, sum(s.salary) as sumsalatbonus
		from salary s,member m  
		where m.id = s.id
		and m.id= #{id} and to_char(day,'yyyy') = to_char(sysdate, 'yyyy') and m.company = 430000004
		group by s.sal_num, s.id, s.day, s.salary, s.state
     </select>


     
     <!-- 검색 날짜가 있을 경우 -->
      <select id = "J_SalaryCalculationSearchCnt2"  parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
    	 select count(*) as cnt
		from salary s,member m  
		where m.id = s.id
		and m.id= #{id} and to_char(day,'yyyy') = #{months} and m.company =  #{company}
     </select>
     <select id = "J_SalaryCalculationSearchList2"  parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgsbVO">
		 select s.sal_num, s.id, s.day, s.salary, s.state, sum(s.salary) as sumsalatbonus
		from salary s,member m  
		where m.id = s.id
		and m.id= #{id} and to_char(day,'yyyy') = #{months} and m.company = 430000004
		group by s.sal_num, s.id, s.day, s.salary, s.state
     </select>
     
     
     
     
     
     
     
</mapper>