<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.spring.gm.persistence.J_DAO" >
	
	<select id="selectCnt" parameterType="int" resultType="int">
		SELECT COUNT(*) as cnt FROM member where depart = #{company}
	</select>
	<!-- 급여 회원정보 가져오기(부서번호가 회사명) -->
	<select id="selectList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, m.rank, m.depart, m.enterday, m.tel, m.email_in, g.g_name, rownum rNum
              FROM member m ,groups g 
              WHERE m.depart = g.company)
        WHERE (rNum >=  #{start} AND rNum <= #{end})  and depart = #{depart};
	]]>
	</select>
	<!-- 급여 회원정보 가져오기(부서번호가 부서명) -->
	<select id="selectList3" parameterType="java.util.Map" resultType="com.spring.gm.vo.join_mgcVO">
	<![CDATA[
		SELECT * FROM(SELECT m.id, m.name, m.rank, m.depart, m.enterday, m.tel, m.email_in, c.c_name as j_name, rownum rNum
              FROM member m ,companies c
              WHERE m.depart = c.company )
        WHERE (rNum >=  #{start} AND rNum <= #{end})  and depart != #{depart}
	]]>
	</select>
	
	<select id="infoList" parameterType="String" resultType="com.spring.gm.vo.MemberVO">
		SELECT * FROM member WHERE id=#{id}
	</select>
	
	<update id="infoUpdate" parameterType="java.util.Map">
		UPDATE member SET salary=#{salary}, account_number=#{account_number} WHERE id=#{id}
	</update>
	
	<!-- 검색 급여 회원정보 가져오기 -->
	<select id="search_salaryCnt" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt FROM member WHERE name like '%'||#{search_content}||'%' and company = #{company}
	</select>
	<select id="search_salaryCnt2" parameterType="java.util.Map" resultType="int">
		SELECT count(*) cnt FROM member WHERE depart like '%'||#{search_content}||'%' and company = #{company}
	</select>
	
	<select id="searchinfoList" parameterType="java.util.Map" resultType="com.spring.gm.vo.MemberVO">
		SELECT * FROM member WHERE name like '%'||#{search_content}||'%' and company = #{company}
	</select>
	<select id="searchinfoList2" parameterType="java.util.Map" resultType="com.spring.gm.vo.MemberVO">
		SELECT * FROM member WHERE depart like '%'||#{search_content}||'%' and company = #{company}
	</select>
</mapper>